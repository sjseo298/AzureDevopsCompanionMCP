# =============================================================================
# CONFIGURACIÓN ORGANIZACIONAL PERSONALIZABLE - SURA COLOMBIA
# =============================================================================
# Este archivo contiene la configuración personalizable por el usuario final
# para adaptar el comportamiento del MCP Server a las necesidades específicas
# de Sura Colombia.
#
# ARCHIVO EDITABLE - Personalice según sus necesidades
# Los cambios en este archivo afectan el comportamiento del sistema
# =============================================================================

# =============================================================================
# INFORMACIÓN ORGANIZACIONAL (REQUERIDA)
# =============================================================================
organization:
  name: "sura-colombia"
  displayName: "Sura Colombia"
  description: "Configuración organizacional para Suramericana de Seguros Colombia"
  
  azure:
    organization: "SuraColombia"
    baseUrl: "https://dev.azure.com/SuraColombia"
    defaultProject: "Gerencia_Tecnologia"

# =============================================================================
# CONFIGURACIÓN DE PROYECTOS (REQUERIDA)
# =============================================================================
projects:
  primary: "gerencia-tecnologia"
  secondary:
    - "gerencia-tecnologia-egv-aseguramiento"
    - "portafolios"
  
  mappings:
    "gerencia-tecnologia":
      displayName: "Desarrollo Principal"
      defaultArea: "Gerencia_Tecnologia"
      defaultIteration: "Gerencia_Tecnologia"
      primaryWorkItemTypes:
        - "Historia"
        - "Historia técnica"
        - "Tarea"
        - "Bug"
    
    "gerencia-tecnologia-egv-aseguramiento":
      displayName: "Aseguramiento EGV"
      defaultArea: "Gerencia_Tecnologia_Egv_Aseguramiento"
      defaultIteration: "Gerencia_Tecnologia_Egv_Aseguramiento"
      primaryWorkItemTypes:
        - "Historia"
        - "Historia técnica"
        - "Caso de prueba"
    
    "portafolios":
      displayName: "Gestión de Portafolios"
      defaultArea: "Portafolios"
      defaultIteration: "Portafolios"
      primaryWorkItemTypes:
        - "Historia"
        - "Entregable"
        - "Entregable de alto nivel"

# =============================================================================
# TIPOS DE WORK ITEMS PERSONALIZADOS (OPCIONAL)
# =============================================================================
workItemTypes:
  custom:
    # CONFIGURACIÓN PARA HISTORIAS
    - name: "Historia"
      baseType: "User Story"
      description: "Historia de usuario personalizada para el contexto de Sura"
      category: "functional"
      
      requiredFields:
        - name: "tipoDeHistoria"
          displayName: "Tipo de Historia"
          fieldName: "Custom.TipoDeHistoria"
          type: "picklistString"
          helpText: "Clasificación funcional de la historia"
          values:
            - "Funcional"
            - "No funcional"
            - "Técnica"
            - "Corrección"
          
        - name: "migracionDatos"
          displayName: "¿Migración de Datos?"
          fieldName: "Custom.Lahistoriahacepartedeunamigraciondedatos"
          type: "boolean"
          helpText: "Indica si la historia involucra migración de datos"
          defaultValue: false
        
        - name: "cumplimientoRegulatorio"
          displayName: "¿Cumplimiento Regulatorio?"
          fieldName: "Custom.Lahistoriacorrespondeauncumplimientoregulatorio"
          type: "boolean"
          helpText: "Indica si es requerimiento regulatorio"
          defaultValue: false
        
        - name: "controlAutomatico"
          displayName: "¿Control Automático?"
          fieldName: "Custom.Lahistoriahaceparteduncontrolautomatico"
          type: "boolean"
          helpText: "Indica si involucra controles automáticos"
          defaultValue: false
        
        - name: "idSolucionAPM"
          displayName: "ID Solución APM"
          fieldName: "Custom.IDdelasolucionenelAPM"
          type: "string"
          helpText: "Identificador de la solución en el sistema APM"

      businessRules:
        - condition: "tipoDeHistoria == 'Técnica'"
          then: "cumplimientoRegulatorio puede ser true"
        
        - condition: "migracionDatos == true"
          then: "idSolucionAPM es obligatorio"

    # CONFIGURACIÓN PARA HISTORIA TÉCNICA
    - name: "Historia técnica"
      baseType: "User Story"
      description: "Historia técnica para implementaciones no funcionales"
      category: "technical"
      
      requiredFields:
        - name: "tipoDeHistoriaTecnica"
          displayName: "Tipo de Historia Técnica"
          fieldName: "Custom.TipoDeHistoriaTecnica"
          type: "picklistString"
          helpText: "Clasificación específica de historia técnica"
          values:
            - "Refactoring"
            - "Configuración"
            - "Infraestructura"
            - "Arquitectura"
            - "Seguridad"
            - "Performance"
            - "Mantenimiento"

    # CONFIGURACIÓN PARA TAREAS
    - name: "Tarea"
      baseType: "Task"
      description: "Tarea de implementación específica"
      category: "implementation"
      
      requiredFields:
        - name: "tipoDeTarea"
          displayName: "Tipo de Tarea"
          fieldName: "Custom.TipoDeTarea"
          type: "picklistString"
          helpText: "Clasificación del tipo de trabajo a realizar"
          values:
            - "Análisis"
            - "Diseño"
            - "Implementación"
            - "Testing"
            - "Documentación"
            - "Despliegue"
            - "Configuración"
            - "Revisión"

    # CONFIGURACIÓN PARA BUGS
    - name: "Bug"
      baseType: "Bug"
      description: "Defecto o problema en el sistema"
      category: "defect"
      
      requiredFields:
        - name: "bloqueante"
          displayName: "¿Es Bloqueante?"
          fieldName: "Custom.Bloqueante"
          type: "boolean"
          helpText: "Indica si impide la continuidad de las pruebas"
          defaultValue: false
        
        - name: "nivelPrueba"
          displayName: "Nivel de Prueba"
          fieldName: "Custom.NivelPrueba"
          type: "picklistString"
          helpText: "Nivel en la pirámide de estrategia de pruebas"
          values:
            - "Unitaria"
            - "Integración"
            - "Sistema"
            - "Aceptación"
            - "Regresión"
        
        - name: "origen"
          displayName: "Origen del Bug"
          fieldName: "Custom.Origen"
          type: "picklistString"
          helpText: "Contexto donde se identificó el bug"
          values:
            - "Manual"
            - "Automatizada"
            - "Exploratoria"
            - "Regresión"
            - "Smoke Test"
        
        - name: "etapaDescubrimiento"
          displayName: "Etapa de Descubrimiento"
          fieldName: "Custom.EtapaDeDescubrimiento"
          type: "picklistString"
          helpText: "Etapa del ciclo de vida donde se encontró"
          values:
            - "Desarrollo"
            - "QA"
            - "Pre-producción"
            - "Producción"
            - "Post-despliegue"

# =============================================================================
# CONFIGURACIÓN DE CAMPOS POR DEFECTO (OPCIONAL)
# =============================================================================
defaultFieldValues:
  # VALORES GLOBALES
  global:
    "Microsoft.VSTS.Common.Priority": 2
    "Microsoft.VSTS.Common.ValueArea": "Business"
    "System.Reason": "New"
  
  # VALORES ESPECÍFICOS POR TIPO
  byWorkItemType:
    "Historia":
      "Custom.Lahistoriahacepartedeunamigraciondedatos": false
      "Custom.Lahistoriacorrespondeauncumplimientoregulatorio": false
      "Custom.Lahistoriahaceparteduncontrolautomatico": false
      "Custom.TipoDeHistoria": "Funcional"
    
    "Historia técnica":
      "Custom.Lahistoriahacepartedeunamigraciondedatos": false
      "Custom.Lahistoriacorrespondeauncumplimientoregulatorio": false
      "Custom.Lahistoriahaceparteduncontrolautomatico": false
      "Custom.TipoDeHistoriaTecnica": "Configuración"
    
    "Bug":
      "Custom.Bloqueante": false
      "Custom.NivelPrueba": "Sistema"
      "Custom.Origen": "Manual"
      "Custom.EtapaDeDescubrimiento": "QA"
      "Microsoft.VSTS.Common.Severity": "3 - Medium"
    
    "Tarea":
      "Custom.TipoDeTarea": "Implementación"
      "Microsoft.VSTS.Scheduling.RemainingWork": 8.0

# =============================================================================
# CONFIGURACIÓN DE VALIDACIONES (OPCIONAL)
# =============================================================================
validation:
  # CONFIGURACIÓN DE SEGURIDAD PARA PREVENIR ERRORES
  safetyRules:
    # Prevenir sobreescritura accidental de descripciones
    preventDescriptionOverwrite: true
    warnOnDescriptionChange: true
    requireConfirmationForCriticalFields: true
    logSecurityWarnings: true
  
  rules:
    # REGLAS PARA HISTORIAS
    "Historia":
      - field: "Custom.IDdelasolucionenelAPM"
        rule: "required_if_condition"
        condition: "Custom.Lahistoriahacepartedeunamigraciondedatos == true"
        message: "ID de solución APM es obligatorio para historias de migración"
      
      - field: "System.Description"
        rule: "not_empty"
        message: "La descripción es obligatoria para historias"
      
      - field: "System.AcceptanceCriteria"
        rule: "not_empty"
        message: "Los criterios de aceptación son obligatorios"
    
    # REGLAS PARA BUGS
    "Bug":
      - field: "Microsoft.VSTS.TCM.ReproSteps"
        rule: "not_empty"
        message: "Los pasos de reproducción son obligatorios"
      
      - field: "Custom.DatosDePrueba"
        rule: "not_empty"
        message: "Los datos de prueba son obligatorios"
      
      - field: "Custom.IDdelasolucionenelAPM"
        rule: "not_empty"
        message: "ID de solución APM es obligatorio para bugs"
    
    # REGLAS PARA TAREAS
    "Tarea":
      - field: "Microsoft.VSTS.Scheduling.RemainingWork"
        rule: "positive_number"
        message: "El trabajo restante debe ser un número positivo"

# =============================================================================
# CONFIGURACIÓN DE PLANTILLAS (OPCIONAL)
# =============================================================================
templates:
  workItemTemplates:
    "Historia Funcional":
      type: "Historia"
      title: "[FUNCIONAL] {Título de la historia}"
      description: |
        ## Contexto
        Describa el contexto de negocio...
        
        ## Criterios de Aceptación
        - [ ] Criterio 1
        - [ ] Criterio 2
        
        ## Definición de Hecho
        - [ ] Código desarrollado
        - [ ] Pruebas unitarias
        - [ ] Documentación actualizada
      fields:
        "Custom.TipoDeHistoria": "Funcional"
        "Microsoft.VSTS.Common.Priority": 2
    
    "Historia de Migración":
      type: "Historia"
      title: "[MIGRACIÓN] {Título de la historia}"
      description: |
        ## Datos a Migrar
        Especificar qué datos se van a migrar...
        
        ## Proceso de Migración
        Describir el proceso paso a paso...
        
        ## Validaciones Post-Migración
        - [ ] Integridad de datos
        - [ ] Consistencia
        - [ ] Performance
      fields:
        "Custom.TipoDeHistoria": "Técnica"
        "Custom.Lahistoriahacepartedeunamigraciondedatos": true
        "Microsoft.VSTS.Common.Priority": 1

    "Bug Crítico":
      type: "Bug"
      title: "[CRÍTICO] {Descripción del problema}"
      reproSteps: |
        ## Pasos para Reproducir
        1. Paso 1
        2. Paso 2
        3. Resultado observado
        
        ## Resultado Esperado
        Describir el comportamiento esperado...
        
        ## Información Adicional
        - Navegador:
        - Sistema Operativo:
        - Datos de prueba utilizados:
      fields:
        "Microsoft.VSTS.Common.Severity": "1 - Critical"
        "Microsoft.VSTS.Common.Priority": 1
        "Custom.Bloqueante": true

# =============================================================================
# CONFIGURACIÓN DE EQUIPOS Y ROLES (OPCIONAL)
# =============================================================================
teamConfiguration:
  defaultAssignments:
    "Historia":
      defaultTeamPrefix: "do"
      suggestedRoles:
        - "Product Owner"
        - "Business Analyst"
    
    "Historia técnica":
      defaultTeamPrefix: "t"
      suggestedRoles:
        - "Tech Lead"
        - "Architect"
    
    "Bug":
      defaultTeamPrefix: "egv-asegur"
      suggestedRoles:
        - "QA Engineer"
        - "Developer"
    
    "Caso de prueba":
      defaultTeamPrefix: "egv-asegur"
      suggestedRoles:
        - "QA Engineer"

  workflowApprovals:
    "Historia":
      transitionToReady:
        requiredApprovals:
          - "Product Owner"
      transitionToDone:
        requiredApprovals:
          - "QA Engineer"
          - "Product Owner"
    
    "Bug":
      transitionToResolved:
        requiredApprovals:
          - "Developer"
      transitionToClosed:
        requiredApprovals:
          - "QA Engineer"

# =============================================================================
# CONFIGURACIÓN DE INTEGRACIONES (OPCIONAL)
# =============================================================================
integrations:
  apm:
    enabled: true
    fieldMapping: "Custom.IDdelasolucionenelAPM"
    validationRequired: true
  
  regulatoryCompliance:
    enabled: true
    trackingField: "Custom.Lahistoriacorrespondeauncumplimientoregulatorio"
    requiredDocumentation: true
  
  automatedControls:
    enabled: true
    trackingField: "Custom.Lahistoriahaceparteduncontrolautomatico"
    auditRequired: true

# =============================================================================
# CONFIGURACIÓN DE REPORTES Y MÉTRICAS (OPCIONAL)
# =============================================================================
reporting:
  dashboards:
    - name: "Cumplimiento Regulatorio"
      filters:
        - "Custom.Lahistoriacorrespondeauncumplimientoregulatorio = true"
      metrics:
        - "Total historias regulatorias"
        - "Tiempo promedio de implementación"
        - "Porcentaje completado"
    
    - name: "Migración de Datos"
      filters:
        - "Custom.Lahistoriahacepartedeunamigraciondedatos = true"
      metrics:
        - "Historias de migración por sprint"
        - "Errores post-migración"
        - "Validaciones exitosas"
    
    - name: "Calidad y Testing"
      filters:
        - "System.WorkItemType = Bug"
        - "Custom.NivelPrueba in (Sistema, Aceptación)"
      metrics:
        - "Defectos por nivel de prueba"
        - "Tiempo de resolución por severidad"
        - "Bugs bloqueantes activos"

  kpis:
    - name: "Velocity de Historias"
      calculation: "Story Points completados por sprint"
      target: "> 30 puntos por sprint"
    
    - name: "Déficit de Calidad"
      calculation: "Bugs/Historias completadas"
      target: "< 0.15 (15%)"
    
    - name: "Cumplimiento Regulatorio"
      calculation: "Historias regulatorias completadas a tiempo"
      target: "> 95%"
